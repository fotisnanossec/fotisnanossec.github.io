<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCAP Analysis Methodology | Tuned for Security</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .code-block {
            background: #1f2937;
            color: #f9fafb;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            margin: 1rem 0;
        }
        .methodology-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .methodology-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <nav class="sticky top-0 z-50 bg-white bg-opacity-90 backdrop-filter backdrop-blur-lg shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-start items-center">
            <a href="../../index.html" class="text-2xl font-bold text-gray-800 transition duration-300 hover:text-gray-600">← Back to Portfolio</a>
        </div>
    </nav>

    <main class="container mx-auto px-6 py-16">
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 mb-4">PCAP Analysis Methodology</h1>
            <p class="text-lg md:text-xl text-gray-600 max-w-2xl mx-auto">
                Systematic network forensics investigation guide developed through hands-on incident response training
            </p>
        </div>

        <!-- Overview -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg shadow-md mb-12">
            <h2 class="text-xl font-bold text-blue-800 mb-3">Investigation Philosophy</h2>
            <p class="text-blue-700 leading-relaxed">
                Network traffic analysis requires systematic methodology to identify threats, reconstruct attack sequences, 
                and extract actionable intelligence. This guide represents practical lessons learned from analyzing 
                malware communications, data exfiltration, and lateral movement scenarios through comprehensive 
                TryHackMe SOC training and real-world packet analysis exercises.
            </p>
        </div>

        <!-- Phase 1: Initial Triage -->
        <div class="methodology-card bg-white p-8 rounded-lg shadow-xl mb-8">
            <div class="flex items-center mb-6">
                <div class="bg-green-100 p-3 rounded-full mr-4">
                    <div class="text-xl font-bold text-green-600">1</div>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Phase 1: Initial Triage & Overview</h2>
                    <p class="text-sm text-gray-600">Time: 5-10 minutes • Goal: Understand traffic scope and identify anomalies</p>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Wireshark Initial Assessment</h3>
                    <div class="code-block">
# Open PCAP and get basic statistics
Statistics > Protocol Hierarchy
Statistics > Conversations
Statistics > Endpoints

# Quick time range check
View > Time Display Format > Date and Time
Statistics > I/O Graph (traffic over time)
                    </div>

                    <h4 class="font-semibold text-gray-700 mb-2 mt-4">Key Questions:</h4>
                    <ul class="space-y-1 text-sm text-gray-700">
                        <li>• What's the time span of the capture?</li>
                        <li>• What protocols are most active?</li>
                        <li>• Are there any unusual ports or protocols?</li>
                        <li>• Any large data transfers or spikes?</li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Command Line Triage</h3>
                    <div class="code-block">
# Basic PCAP information
capinfos capture.pcap

# Protocol summary
tshark -r capture.pcap -q -z prot,stat

# Conversation overview
tshark -r capture.pcap -q -z conv,ip
tshark -r capture.pcap -q -z conv,tcp
                    </div>

                    <h4 class="font-semibold text-gray-700 mb-2 mt-4">Red Flags to Look For:</h4>
                    <ul class="space-y-1 text-sm text-gray-700">
                        <li>• High-numbered ports (potential C2)</li>
                        <li>• DNS queries to suspicious domains</li>
                        <li>• Unusual protocols (DNS over HTTPS, tunneling)</li>
                        <li>• Large file transfers to external IPs</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Phase 2: Network Mapping -->
        <div class="methodology-card bg-white p-8 rounded-lg shadow-xl mb-8">
            <div class="flex items-center mb-6">
                <div class="bg-blue-100 p-3 rounded-full mr-4">
                    <div class="text-xl font-bold text-blue-600">2</div>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Phase 2: Network Mapping & Asset Identification</h2>
                    <p class="text-sm text-gray-600">Time: 10-15 minutes • Goal: Map network topology and identify key systems</p>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Internal vs External Classification</h3>
                    <div class="code-block">
# Identify internal networks (common ranges)
ip.src_host == 192.168.0.0/16 or ip.src_host == 10.0.0.0/8 or ip.src_host == 172.16.0.0/12

# External communications
!(ip.src_host == 192.168.0.0/16 or ip.src_host == 10.0.0.0/8 or ip.src_host == 172.16.0.0/12)

# Most active internal hosts
tshark -r capture.pcap -T fields -e ip.src | sort | uniq -c | sort -nr | head -10
                    </div>

                    <h4 class="font-semibold text-gray-700 mb-2 mt-4">Asset Identification:</h4>
                    <ul class="space-y-1 text-sm text-gray-700">
                        <li>• Web servers (ports 80, 443, 8080)</li>
                        <li>• Domain controllers (ports 389, 636, 88)</li>
                        <li>• File servers (ports 445, 139)</li>
                        <li>• Database servers (ports 1433, 3306, 5432)</li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">DNS Analysis for Asset Discovery</h3>
                    <div class="code-block">
# Extract all DNS queries and responses
dns

# Find internal domain structure
tshark -r capture.pcap -Y "dns" -T fields -e dns.qry.name | sort | uniq

# Identify DNS servers
tshark -r capture.pcap -Y "dns" -T fields -e ip.src -e ip.dst | sort | uniq
                    </div>

                    <h4 class="font-semibold text-gray-700 mb-2 mt-4">Network Behavior Patterns:</h4>
                    <ul class="space-y-1 text-sm text-gray-700">
                        <li>• Broadcast traffic (ARP, NetBIOS)</li>
                        <li>• Regular heartbeats or beacons</li>
                        <li>• Authentication traffic patterns</li>
                        <li>• Backup or synchronization traffic</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Phase 3: Threat Hunting -->
        <div class="methodology-card bg-white p-8 rounded-lg shadow-xl mb-8">
            <div class="flex items-center mb-6">
                <div class="bg-red-100 p-3 rounded-full mr-4">
                    <div class="text-xl font-bold text-red-600">3</div>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Phase 3: Threat Hunting & Anomaly Detection</h2>
                    <p class="text-sm text-gray-600">Time: 20-30 minutes • Goal: Identify malicious activity and IOCs</p>
                </div>
            </div>

            <div class="space-y-6">
                <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                    <h3 class="text-lg font-semibold text-red-800 mb-3">C2 Communication Detection</h3>
                    <div class="code-block">
# Look for regular beacons (consistent timing)
tshark -r capture.pcap -T fields -e frame.time_relative -e ip.src -e ip.dst -e tcp.dstport | awk '{print $1, $4}' | sort

# High-numbered destination ports (potential C2)
tcp.dstport > 8000 and tcp.dstport < 65535

# Suspicious DNS queries
dns.qry.name contains ".tk" or dns.qry.name contains ".ml" or dns.qry.name contains "dga"

# HTTP POST with small responses (potential C2)
http.request.method == "POST" and http.response.code == 200
                    </div>
                </div>

                <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                    <h3 class="text-lg font-semibold text-orange-800 mb-3">Data Exfiltration Indicators</h3>
                    <div class="code-block">
# Large outbound transfers
ip.len > 1000 and ip.src == [internal_ip] and not ip.dst == [internal_range]

# DNS tunneling detection
dns.qry.name.len > 50 or dns.resp.len > 512

# Base64 encoded data in HTTP
http contains "base64" or http.request.uri contains "data="

# File uploads via HTTP POST
http.request.method == "POST" and http.content_type contains "multipart"
                    </div>
                </div>

                <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
                    <h3 class="text-lg font-semibold text-purple-800 mb-3">Lateral Movement Detection</h3>
                    <div class="code-block">
# SMB activity between internal hosts
smb and not (ip.src == [domain_controller] or ip.dst == [domain_controller])

# RDP connections
tcp.port == 3389

# WMI or PowerShell remoting
tcp.port == 5985 or tcp.port == 5986

# Pass-the-hash indicators
ntlmssp.auth.username != "" and kerberos
                    </div>
                </div>
            </div>
        </div>

        <!-- Phase 4: Deep Dive Analysis -->
        <div class="methodology-card bg-white p-8 rounded-lg shadow-xl mb-8">
            <div class="flex items-center mb-6">
                <div class="bg-purple-100 p-3 rounded-full mr-4">
                    <div class="text-xl font-bold text-purple-600">4</div>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Phase 4: Deep Dive Analysis & Reconstruction</h2>
                    <p class="text-sm text-gray-600">Time: 30-60 minutes • Goal: Reconstruct attack timeline and extract evidence</p>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">TCP Stream Analysis</h3>
                    <div class="code-block">
# Follow specific TCP streams
tcp.stream eq 0

# Extract HTTP objects
File > Export Objects > HTTP

# Search for specific content
Edit > Find Packet > String search

# Timeline reconstruction
View > Time Display Format > Seconds Since Previous
                    </div>

                    <h3 class="text-lg font-semibold text-gray-700 mb-3 mt-4">Data Recovery Techniques</h3>
                    <div class="code-block">
# DNS exfiltration reconstruction
tshark -r capture.pcap -Y 'dns' -T fields -e dns.qry.name | 
grep ".attacker.com" | cut -f1 -d '.' | xxd -r -p

# Base64 decoding from HTTP
tshark -r capture.pcap -Y 'http' -T fields -e http.request.uri | 
grep "data=" | cut -d'=' -f2 | base64 -d
                    </div>
                </div>

                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Evidence Documentation</h3>
                    <div class="bg-gray-50 p-4 rounded">
                        <h4 class="font-semibold text-gray-800 mb-2">Key Evidence to Extract:</h4>
                        <ul class="space-y-2 text-sm text-gray-700">
                            <li>• Malicious file downloads (URLs, hashes)</li>
                            <li>• C2 server IP addresses and domains</li>
                            <li>• Exfiltrated data samples</li>
                            <li>• Attack timestamps and duration</li>
                            <li>• Affected systems and user accounts</li>
                            <li>• Network paths and protocols used</li>
                        </ul>
                    </div>

                    <h3 class="text-lg font-semibold text-gray-700 mb-3 mt-4">Advanced Analysis Tools</h3>
                    <div class="code-block">
# Zeek log analysis (if available)
zeek -r capture.pcap
cat conn.log | zeek-cut ts id.orig_h id.resp_h service
cat http.log | zeek-cut ts method host uri
cat dns.log | zeek-cut ts query answers

# NetworkMiner analysis
# 1. Load PCAP
# 2. Check Hosts tab for endpoints
# 3. Files tab for extracted objects
# 4. Parameters tab for credentials
                    </div>
                </div>
            </div>
        </div>

        <!-- Common Investigation Scenarios -->
        <div class="bg-gradient-to-r from-gray-900 to-gray-800 text-white p-8 rounded-lg shadow-xl mb-12">
            <h2 class="text-2xl font-bold mb-6 text-center">Common Investigation Scenarios</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-3 text-blue-300">Malware C2 Analysis</h3>
                    <ul class="space-y-2 text-sm">
                        <li>• Identify beacon intervals</li>
                        <li>• Extract C2 domains/IPs</li>
                        <li>• Analyze command structure</li>
                        <li>• Map infection timeline</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-3 text-green-300">Data Exfiltration Investigation</h3>
                    <ul class="space-y-2 text-sm">
                        <li>• Identify large outbound transfers</li>
                        <li>• Detect DNS/HTTP tunneling</li>
                        <li>• Recover exfiltrated samples</li>
                        <li>• Map data sources</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-3 text-yellow-300">Insider Threat Analysis</h3>
                    <ul class="space-y-2 text-sm">
                        <li>• Track user activity patterns</li>
                        <li>• Identify unusual access times</li>
                        <li>• Monitor file server access</li>
                        <li>• Detect privilege escalation</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Tool Integration -->
        <div class="bg-white p-8 rounded-lg shadow-xl mb-12">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Tool Integration & Workflow</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Primary Analysis Tools</h3>
                    <div class="space-y-4">
                        <div class="flex items-center p-3 bg-gray-50 rounded">
                            <div class="bg-blue-100 p-2 rounded mr-3">
                                <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-semibold">Wireshark</h4>
                                <p class="text-sm text-gray-600">Deep packet inspection and stream analysis</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded">
                            <div class="bg-green-100 p-2 rounded mr-3">
                                <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-semibold">TShark</h4>
                                <p class="text-sm text-gray-600">Command-line analysis and automation</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded">
                            <div class="bg-purple-100 p-2 rounded mr-3">
                                <svg class="w-5 h-5 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <h4 class="font-semibold">Zeek/Brim</h4>
                                <p class="text-sm text-gray-600">Network monitoring and log correlation</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="text-xl font-semibold text-gray-700 mb-4">Analysis Checklist</h3>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">Basic traffic overview and statistics</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">Network topology and asset identification</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">DNS analysis and domain reputation</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">HTTP/HTTPS traffic examination</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">C2 beacon detection and analysis</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">Data exfiltration pattern identification</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">Timeline reconstruction and documentation</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <span class="text-sm">IOC extraction and threat intelligence</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Background -->
        <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-8 rounded-lg shadow-xl">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">Methodology Development</h2>
            <div class="text-center max-w-4xl mx-auto">
                <p class="text-gray-700 leading-relaxed mb-4">
                    This methodology was developed through intensive hands-on training with TryHackMe's SOC Level 1 path, 
                    analyzing real-world incident scenarios including the Boogeyman series investigations. Each phase 
                    represents practical lessons learned from investigating malware communications, DNS tunneling, 
                    PowerShell-based attacks, and advanced persistent threats.
                </p>
                <div class="flex justify-center space-x-4 mt-6">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold">Network Forensics</span>
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded text-sm font-semibold">Incident Response</span>
                    <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded text-sm font-semibold">Threat Hunting</span>
                    <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded text-sm font-semibold">Malware Analysis</span>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 text-gray-300 py-6 text-center">
        <div class="container mx-auto px-6">
            <p>&copy; 2025 Tuned for Security. All rights reserved.</p>
        </div>
    </footer>
    
</body>
</html>